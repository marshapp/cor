\documentclass[11pt]{article}
\usepackage{graphicx} % Required for inserting images
\usepackage[top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{setspace}
\setlength{\parindent}{0in}
\usepackage{physics}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage[outline]{contour} % glow around text
\usepackage{xcolor}
\usepackage{float}
\usepackage{makeidx}
\usepackage{fancyhdr}
\usepackage{pgfplots}
\usepackage{amsmath}
\pgfplotsset{compat=1.18}
\usepackage{caption}
\usepackage[english,catalan]{babel}
\setlength{\parskip}{11pt}
\usepackage{xcolor}
\usepackage{listings}


\title{\Huge\bfseries Cor:Cor \\[1ex] \Large}

\author{\begin{tabular}{c}
\textbf{GRUP C3} \\
Isaac \\
Marcel López Freixes (1668323) \\
Eira Jacas García (1666616) \\
Núria Castillo Ariño (1669145)
\end{tabular}}

\date{02/12/2024}

\begin{document}

\maketitle

\section{Introducció}


Tenim 

\begin{equation}
    c_v \rho \frac{\partial T}{\partial t} = \nabla \cdot (\kappa \nabla T) + P_{\text{ext}}
\label{eq: eq_inicial}
\end{equation}


Si simplifiquem el sistema un espai cilíndricament simètric, ens queda


\begin{equation}
    c_v \rho \frac{\partial T}{\partial t} = \frac{\partial^2 T}{\partial x^2} + P_{\text{ext}}
\label{eq: eq_inicial_cilindriques}
\end{equation}
\section{normalització}

Dividint l'eq. \eqref{eq: eq_inicial_cilindriques} per $c_v\rho$ i definint $\lambda=\frac{P_ext}{\rho c_v}$, queda

\begin{equation}
    \frac{\partial T}{\partial t} = \alpha \frac{\partial^2 T}{\partial x^2} + \lambda \implies \frac{1}{\lambda}\frac{\partial T}{\partial t} = \frac{\alpha}{\lambda} \frac{\partial^2 T}{\partial x^2} + 1
\label{eq: eq_entre_rhocv}
\end{equation}

on $\alpha=\frac{k}{\rho c_v}$ és la difusivitat tèrmica.

Si definim $\hat{x}=\frac{x}{L}$, $\hat{T}=T \frac{\alpha}{\lambda L^2}$ i $\hat{t}=t\frac{\alpha}{L^2}$, aleshores

\begin{equation}
    \frac{\partial \hat{T}}{\partial \hat{t}} = \frac{\partial^2 \hat{T}}{\partial \hat{x}^2} + 1
\label{eq: eq_normalitzada}
\end{equation}

\section{Solució analítica}


Seguint la solució de proposada a l'annex del guió amb $q(x,t)=1$ i $\beta=\hat{T}(T_c)$, queda que



\begin{equation}
    f(\hat{x}, \hat{t}) = \beta + \frac{4}{\pi^3} \sum_{n=1}^{\infty} \frac{1 - e^{-(2n-1)^2 \pi^2 \hat{t}}}{(2n-1)^3} \sin\big((2n-1)\pi \hat{x})
\label{eq: analitica}
\end{equation}


\section{Solucio numèrica: Euler explicit}

Per aplicar el mètode numèric d'euler explicit

\begin{equation}
    \frac{\partial \hat{T}}{\partial \hat{t}} = \frac{\hat{T}_j^{n+1} - \hat{T}_j^n}{\Delta \hat{t}} \ .
    \label{derivada per la dreta}
\end{equation}

\begin{equation}
    \frac{\delta^2 \hat{T}}{\delta \hat{z}^2} = \frac{\hat{T}_{j+1}^n - 2\hat{T}_{j}^n + \hat{T}_{j-1}^n}{\Delta \hat{z}^2}
    \label{2a derivada espaial}
\end{equation}

\section{Euler implícit}
En aquest mètode la derivada espacial de l'Eq. \eqref{eq: eq_normalitzada} es calcula de la mateixa manera que en l'explícit, és a dir, a partir de l'Eq. \eqref{2a derivada espaial}. La diferència recau en el càlcul de la derivada temporal: mentre que en el mètode explícit s'utilitza l'aproximació de la derivada per la dreta, en l'implícit s'aplica l'aproximació per l'esquerra. Aquesta última ve donada per l'expressió següent:
\begin{equation}
    \frac{\partial \hat{T}}{\partial \hat{t}} = \frac{\hat{T}_j^n - \hat{T}_j^{n-1}}{\Delta \hat{t}} \ .
    \label{derivada per lesquerra}
\end{equation}

Substituint les aproximacions de les derivades corresponentment a l'equació diferencial i aïllant $\hat{T}_j^n$, s'obté:
\begin{equation}
    \hat{T}_j^n = \frac{\gamma \left( \hat{T}_{j+1}^n + \hat{T}_{j-1}^n \right) + \hat{T}_j^{n-1} + \Delta \hat{t}}{1 + 2\gamma}
    \label{Tnj implicit} \ .
\end{equation}

A la part dreta de la igualtat apareixen temperatures en el pas temporal $n$. Per tant, no és possible aïllar $\hat{T}_j^n$ en funció de temperatures únicament en temps anteriors.  Així doncs, efectivament l'equació és implícita. 

Per les condicions inicials i de contorn, les temperatures en $j=1$, $j=N$ i $n=1$ no són variables sinó valors ja coneguts. Concretament, $\hat{T}_j^1=\hat{T}_1^n=\hat{T}_N^n = \beta$. Així doncs, per a $j=2$ i $j=N-1$ cal utilitzar expressions modificades:
\begin{align}
    \hat{T}_2^n = \frac{\gamma \hat{T}_3^n + \beta(\gamma+1)+\Delta\hat{t}}{2\gamma+1} \ ; \label{T_2^n implicit} \\
    \hat{T}_{N-1}^n = \frac{\gamma \hat{T}_{N-2}^n + \beta(\gamma+1)+\Delta\hat{t}}{2\gamma+1} \ . \label{T_N-1^n implicit}
\end{align}

La resolució numèrica d'aquest problema es planteja com un sistema d'equacions algebraiques que cal resoldre iterativament en cada pas temporal $n$. Partint de les condicions inicials, es resol successivament per obtenir les temperatures dels passos següents de forma recursiva, aprofitant que els valors de $\hat{T}_j^{n-1}$ són coneguts del pas anterior.

El sistema es pot expressar en forma matricial per a cada pas $n$. Per resoldre'l, utilitzem el mètode iteratiu de Gauss-Seidel.

\section{Solució: numèrica: mètode Crank-Nicolson}
En aquest mètode numèric es discretitza la derivada temporal com l'Eq. \eqref{derivada per la dreta} i la segona derivada espacial com la mitjana de les dues posicions considerades a la discretització de la derivada temporal. Aquesta dona l'expressió següent:
\begin{equation}
    \a
    \label{discretitzacio crank}
\end{equation}

La resolució numèrica d'aquest problema també es planteja com un sistema d'equacions algebraiques, una per cada pas espacial, que cal resoldre iterativament per cada pas temporal $a$. Com en el mètode d'Euler implícit, es parteix de les condicions inicials i es resol successivament per obtenir les temperatures dels passos següents de forma recursiva, aprofitant que els valors de $\hat{T}_j^{n-1}$ són coneguts del pas anterior.

El sistema es pot expressar en forma matricial per a cada pas $a$. Per resoldre'l, utilitzem el mètode iteratiu de Jacobi.

\end{document}
